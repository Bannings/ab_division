## AB分流服务说明

### 基本概念
- 本服务仅提供分流策略，更深层次的实验组，分层的逻辑本服务不涉及
- 本服务分流依据用户唯一标识号分流，例如手机设备号，保证同一用户设备在一次实验中分流策略不会改变
- 实验表（strategy_experiment）中，salt字段要保证每个实验唯一，保证实验之间正交性
- 实验桶（strategy_bucket）中，allocation_percent为该桶对应分流百分比，同一实验所有桶和应为100


### 服务启动流程
1. 加载所有处于RUNNING状态实验，在依次加载每个实验对应桶数据，校验桶分流之和是否为100
2. 将实验数据，包括桶数据，桶分流表加载至内存中，每隔10分钟更新一次相应数据

### 请求处理流程
1. 根据请求用户与业务ID数据，找到对应的正在运行的所有实验
2. 将用户设备号转为bigint型数据，对100求余。（string转bigint，保证输入变化输出变化完全随机，分布均匀，参考测试用例(ab_division_test）
3. 根据求余数找到对应桶的比例，参考util.calculationDivision方法

- GetABDivision请求参数

| 请求参数 | 参数类型 | 是否必填 | 参数说明 |
|:------ |:------ |:------ |:------ |
| Uid | int64 | 是|用户ID |
| Udid | string | 是| 唯一标识一台硬件设备ID |
| Gender | Gender | 否 | 用户性别，0为男，1为女（默认为男） |
| Version | string | 否 | 版本号 |
| Channel | string | 否 | 渠道 |
| BusinessId | string | 是 | 业务ID |
